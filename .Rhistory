?coalesce
?map_chr
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, furrr, rvest, ggthemes, lubridate)
?map_chr
?future_map
?str_sub
knitr::opts_chunk$set(echo = TRUE)
```{r}
pacman::p_load(tidyverse, furrr, rvest, ggthemes, lubridate)
plan(multiprocess)
indexpage <- read_html(XXV)
XXV
# Reading stable URLs
XXV <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXV
indexpage <- read_html(XXV)
indexpage
```{r}
indexpage <- read_html(url)
indexpage <- read_html(XXV)
indexpage <- read_html("https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT=)
proposalpages <- indexpage %>%
html_nodes("a.link-indicator") %>%
indexpage <- read_html("https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT=")
indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src")
indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
str_extract(., "[1-9]")
?substitute()
indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
str_extract(., "[1-9]") %>%
unique()
?str_replace
?str_c
?str_replace
?ifelse
indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
str_extract(., "[1-9]") %>%
ifelse(x = 5, "beschlossen", "nicht beschlossen")
indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
str_extract(., "[1-9]") %>%
str_replace_all(.,c("5" = "beschlossen",
"4" = "nicht beschlossen",
"3" = "nicht beschlossen",
"2" = "nicht beschlossen",
"1" = "nicht beschlossen"))
setwd("C:/Users/Felix/OneDrive - bwedu/Documents/Studium/AG Breunig/Ben/scraping_felix/R")
scrape_indexpage(XXV)
# get proposal pages URLs
scrape_indexpage <- function(url) { # URL = XXV, XXIV, XXIII, ...
indexpage <- read_html(url)
proposalpages <- indexpage %>%
html_nodes("a.link-indicator") %>%
html_attr("href") %>%
.[seq(1, length(.), by = 2)] %>%
paste0("https://www.parlament.gv.at", .)
# get dates of proposals (website upload?), type (RV, A, VOLKBG, BRA), descriptive title,
indexpagedata <- indexpage %>%
html_nodes(., "span.table-responsive__inner") %>%
html_text(., trim = T) %>%  # get table inner text and trim
matrix(., ncol = 5, byrow = T) %>%  # put into matrix, then dataframe (tibble)
.[, -5] %>%
as_tibble(., .name_repair = "minimal") %>%
setNames(., c("web_date", "type", "desc_title", "proposal_id"))
# add proposal pages URLs
indexpagedata$proposal_link <- proposalpages
# adding legislative period indicator
indexpagedata$period <- url %>%
str_extract(., "GP=\\w+") %>%
str_sub(., start = 4)
# add rudimentary status according to status bar (image)
indexpagedata$status <- indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
str_extract(., "[1-9]") %>%
str_replace_all(.,c("5" = "beschlossen",
"4" = "nicht beschlossen",
"3" = "nicht beschlossen",
"2" = "nicht beschlossen",
"1" = "nicht beschlossen"))
# cleaning proposal IDs to be used as filenames
indexpagedata$proposal_filename <- indexpagedata$proposal_id %>%
gsub("[^A-Za-z0-9]", "" , .) %>%
paste(indexpagedata$period, ., sep = "_")
#exporting to appropriatly named .csv
write.csv(indexpagedata, file = paste0(indexpagedata$period[1], ".csv"))
}
scrape_indexpage(XXV)
scrape_indexpage(XXV)
scrape_indexpage(XXV)
indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
str_extract(., "[1-9]")
# get proposal pages URLs
scrape_indexpage <- function(url) { # URL = XXV, XXIV, XXIII, ...
indexpage <- read_html(url)
proposalpages <- indexpage %>%
html_nodes("a.link-indicator") %>%
html_attr("href") %>%
.[seq(1, length(.), by = 2)] %>%
paste0("https://www.parlament.gv.at", .)
# get dates of proposals (website upload?), type (RV, A, VOLKBG, BRA), descriptive title,
indexpagedata <- indexpage %>%
html_nodes(., "span.table-responsive__inner") %>%
html_text(., trim = T) %>%  # get table inner text and trim
matrix(., ncol = 5, byrow = T) %>%  # put into matrix, then dataframe (tibble)
.[, -5] %>%
as_tibble(., .name_repair = "minimal") %>%
setNames(., c("web_date", "type", "desc_title", "proposal_id"))
# add proposal pages URLs
indexpagedata$proposal_link <- proposalpages
# adding legislative period indicator
indexpagedata$period <- url %>%
str_extract(., "GP=\\w+") %>%
str_sub(., start = 4)
# add rudimentary status according to status bar (image)
indexpagedata$status <- indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
.[seq(1, length(.), by = 2)] %>%
str_extract(., "[1-9]") %>%
str_replace_all(.,c("5" = "beschlossen",
"4" = "nicht beschlossen",
"3" = "nicht beschlossen",
"2" = "nicht beschlossen",
"1" = "nicht beschlossen"))
# cleaning proposal IDs to be used as filenames
indexpagedata$proposal_filename <- indexpagedata$proposal_id %>%
gsub("[^A-Za-z0-9]", "" , .) %>%
paste(indexpagedata$period, ., sep = "_")
#exporting to appropriatly named .csv
write.csv(indexpagedata, file = paste0(indexpagedata$period[1], ".csv"))
}
scrape_indexpage(XXV)
4 <- 2
?write.csv
?rbind
# Reading stable URLs
XXV <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
# Reading stable URLs
XXV <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXIV <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXIV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXIII <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXIII&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXII <-"https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXII&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXI <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXI&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XX <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XX&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
scrape_indexpage(c("XXV", "XXIV"))
scrape_indexpage(XXIV)
scrape_indexpage(XXIII)
scrape_indexpage(XXII)
scrape_indexpage(XXI)
scrape_indexpage(XX)
XXV <- read.csv(XXV)
XXV
View(XXV)
scrape_indexpage(XXV)
# Reading stable URLs
XXV <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXIV <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXIV&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXIII <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXIII&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXII <-"https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXII&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XXI <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XXI&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
XX <- "https://www.parlament.gv.at/PAKT/VHG/index.shtml?VV=&pageNumber=&ZUAS=ALLE&ALT=&feldRnr=5&FR=ALLE&R_MSFRASZU=MIN&LDAP_GRP(PM_ESM)=N&DR=&FBEZ=FP_001&view=&VHG=GESVOR&VHG2=ALLE&jsMode=&VHG3=ALLE&requestId=C536DCDD28&VHG4=ALLE&MISS=&listeId=100&ALTKN=&filterJq=&AUS=ALLE&SUCH=&DEB=&xdocumentUri=%2FPAKT%2FVHG%2Findex.shtml&R_MFRAS=MIN&GP=XX&STEP=2905&INTRANET=N&LDAP_GRP(PM_HA)=N&ZUFR=ALLE&NAB=&SID=ALLE&ascDesc=DESC&NRBR=NR&ALTPN=&GBEZ=&AS=ALLE&MIN=ALLE&LISTE=&ZUSTIMM=ALLE&LH=ALLE&GESVOR=ALLE&ZEIT="
df_XXV <- read.csv(XXV)
df_XXV <- read.csv(XXV)
df_XXIV <- read.csv(XXIV)
df_XXIII <- read.csv(XXIII)
df_XXII <- read.csv(XXII)
df_XXI <- read.csv(XXI)
df_XX <- read.csv(XX)
df_XXIII <- read.csv(XXIII)
df_XXII <- read.csv(XXII)
df_XXI <- read.csv(XXI)
df_XX <- read.csv(XX)
all_indexpagedata <- rbind(XXV, XXIV, XXIII, XXII, XXI, XX)
write.csv(all_in
write.csv(all_indexpagedata, file = indexpagedata.csv)
write.csv(all_indexpagedata, file = indexpagedata.csv)
write.csv(all_indexpagedata, file = "indexpagedata.csv")
nrow()
nrow(all_indexpagedata)
View(all_indexpagedata)
?read.csv()
df_XXV <- read.csv(XXV.csv)
#exporting to appropriatly named .csv
write.csv(indexpagedata, file = paste0("df_", indexpagedata$period[1], ".csv"))
# get proposal pages URLs
scrape_indexpage <- function(url) { # URL = XXV, XXIV, XXIII, ...
indexpage <- read_html(url)
proposalpages <- indexpage %>%
html_nodes("a.link-indicator") %>%
html_attr("href") %>%
.[seq(1, length(.), by = 2)] %>%
paste0("https://www.parlament.gv.at", .)
# get dates of proposals (website upload?), type (RV, A, VOLKBG, BRA), descriptive title,
indexpagedata <- indexpage %>%
html_nodes(., "span.table-responsive__inner") %>%
html_text(., trim = T) %>%  # get table inner text and trim
matrix(., ncol = 5, byrow = T) %>%  # put into matrix, then dataframe (tibble)
.[, -5] %>%
as_tibble(., .name_repair = "minimal") %>%
setNames(., c("web_date", "type", "desc_title", "proposal_id"))
# add proposal pages URLs
indexpagedata$proposal_link <- proposalpages
# adding legislative period indicator
indexpagedata$period <- url %>%
str_extract(., "GP=\\w+") %>%
str_sub(., start = 4)
# add rudimentary status according to status bar (image)
indexpagedata$status <- indexpage %>%
html_nodes(., "img.status") %>%
html_attr("src") %>%
.[seq(1, length(.), by = 2)] %>%
str_extract(., "[1-9]") %>%
str_replace_all(.,c("5" = "beschlossen",
"4" = "nicht beschlossen",
"3" = "nicht beschlossen",
"2" = "nicht beschlossen",
"1" = "nicht beschlossen"))
# cleaning proposal IDs to be used as filenames
indexpagedata$proposal_filename <- indexpagedata$proposal_id %>%
gsub("[^A-Za-z0-9]", "" , .) %>%
paste(indexpagedata$period, ., sep = "_")
#exporting to appropriatly named .csv
write.csv(indexpagedata, file = paste0("df_", indexpagedata$period[1], ".csv"))
}
scrape_indexpage(XXV)
scrape_indexpage(XXIV)
scrape_indexpage(XXIII)
scrape_indexpage(XXII)
scrape_indexpage(XXI)
scrape_indexpage(XX)
View(df_XX)
View(df_XX)
View(df_XX)
View(df_XX)
View(df_XX)
df_XXV <- read.csv(df_XXV)
df_XXV <- read.csv(df_XXV.csv)
setwd("C:/Users/Felix/OneDrive - bwedu/Documents/Studium/AG Breunig/Ben/scraping_felix/R")
df_XXV <- read.csv(df_XXV)
pacman::p_load(tidyverse, furrr, rvest, ggthemes, lubridate, rio)
?import
df_XXV <- import(df_XXV.csv)
df_XXV <- import(df_XXV.csv)
df_XXIV <- read.csv(df_XXIV)
wd
?wd
setwd("C:/Users/Felix/OneDrive - bwedu/Documents/Studium/AG Breunig/Ben/scraping_felix/R")
df_XXV <- import(df_XXV.csv)
df_XXV <- import(df_XXV)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, furrr, rvest, ggthemes, lubridate, rio)
df_XXV <- import(df_XXV.csv)
df_XXIV <- read.csv(df_XXIV)
df_XXV <- import("df_XXV.csv")
View(df_XXV)
df_XXIV <- read.csv("df_XXIV")
df_XXIV <- read.csv("df_XXIV")
View(df_XXV)
?read.csv
df_XXV <- read.csv(df_XXV, header = TRUE)
df_XXV <- read.csv("df_XXV", header = TRUE)
df_XXV <- read.csv(file = "de_XXV.csv", header = TRUE)
df_XXV <- read.csv(file = "de_XXV.csv", header = TRUE)
df_XXV <- read.csv(file = 'de_XXV.csv', header = TRUE)
set.wd()
setwd()
?setwd
getwd
getwd()
df_XXV <- read.csv(file = 'de_XXV.csv', header = TRUE)
